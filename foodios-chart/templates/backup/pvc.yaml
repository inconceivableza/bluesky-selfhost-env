# NOTE: This file is no longer used for the backup StatefulSet.
#
# The backup service now uses a StatefulSet (instead of Deployment) which
# automatically creates PVCs via volumeClaimTemplates:
#   - backup-staging-backup-0 (for pod backup-0)
#   - backup-repo-backup-0 (for pod backup-0)
#   - backup-staging-backup-1 (for pod backup-1, if scaled)
#   - etc.
#
# This ensures each backup pod has its own isolated storage, preventing:
#   - Race conditions in staging area
#   - Lock file conflicts in Restic repository
#   - Backup corruption from concurrent operations
#
# If you need to manually create PVCs (e.g., for testing without StatefulSet),
# uncomment the configuration below:

# {{- if .Values.backup.enabled }}
# ---
# apiVersion: v1
# kind: PersistentVolumeClaim
# metadata:
#   name: backup-staging
#   namespace: {{ .Values.global.namespace }}
#   labels:
#     app: backup
#     {{- include "foodios.labels" . | nindent 4 }}
# spec:
#   accessModes:
#     - ReadWriteOnce
#   {{- if .Values.backup.staging.storageClass }}
#   storageClassName: {{ .Values.backup.staging.storageClass }}
#   {{- end }}
#   resources:
#     requests:
#       storage: {{ .Values.backup.staging.size | default "20Gi" }}
# ---
# apiVersion: v1
# kind: PersistentVolumeClaim
# metadata:
#   name: backup-repo
#   namespace: {{ .Values.global.namespace }}
#   labels:
#     app: backup
#     {{- include "foodios.labels" . | nindent 4 }}
# spec:
#   accessModes:
#     - ReadWriteOnce
#   {{- if .Values.backup.repo.storageClass }}
#   storageClassName: {{ .Values.backup.repo.storageClass }}
#   {{- end }}
#   resources:
#     requests:
#       storage: {{ .Values.backup.repo.size | default "100Gi" }}
# {{- end }}
