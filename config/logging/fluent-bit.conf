[SERVICE]
    Flush        5
    Daemon       Off
    Log_Level    info
    Parsers_File parsers.conf

# Docker container logs
[INPUT]
    Name              tail
    Path              /var/lib/docker/containers/*/*.log
    Parser            docker
    Tag               docker.*
    Refresh_Interval  5
    Mem_Buf_Limit     50MB
    Skip_Long_Lines   On
    Docker_Mode       On

# Parse JSON logs if containers output JSON
[FILTER]
    Name                parser
    Match               docker.*
    Key_Name            log
    Parser              json
    Reserve_Data        On
    Preserve_Key        On

# Output all logs to OpenSearch
[OUTPUT]
    Name                opensearch
    Match               docker.*
    Host                ${OPENSEARCH_HOST}
    Port                ${OPENSEARCH_PORT}
    Index               logs
    Type                _doc
    Logstash_Format     On
    Logstash_Prefix     logs
    Logstash_DateFormat %Y.%m.%d
    Suppress_Type_Name  On
    Retry_Limit         5
    Trace_Error         On
